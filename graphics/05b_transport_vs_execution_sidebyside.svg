<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 620" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <rect width="960" height="620" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="36" font-size="22" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">Two Experiments: What Actually Improves UDF Performance?</text>
  <text x="480" y="56" font-size="13" fill="#718096" text-anchor="middle">Same @udf baseline (48.5x at 50M rows). Change one axis at a time. Only one makes a difference.</text>

  <!-- ═══ LEFT PANEL: Change Transport ═══ -->
  <rect x="25" y="74" width="440" height="370" rx="10" fill="#FFF5F5" stroke="#FED7D7"/>
  <text x="245" y="100" font-size="16" fill="#D13913" text-anchor="middle" font-weight="bold">Experiment 1: Change Transport</text>
  <text x="245" y="118" font-size="11" fill="#9B2C2C" text-anchor="middle">Same execution model, different wire format</text>

  <!-- Bar: @udf (pickle) -->
  <text x="50" y="154" font-size="11" fill="#4A5568">@udf (default)</text>
  <text x="50" y="168" font-size="10" fill="#A0AEC0">pickle serialization</text>
  <rect x="50" y="178" width="390" height="36" rx="6" fill="#D13913"/>
  <text x="430" y="202" font-size="18" fill="#FFFFFF" font-weight="bold" text-anchor="end">48.5x</text>
  <text x="60" y="202" font-size="12" fill="#FFFFFF">5.20s at 50M</text>

  <!-- Big equals sign -->
  <text x="245" y="244" font-size="36" fill="#A0AEC0" text-anchor="middle">=</text>

  <!-- Bar: @udf + arrow config -->
  <text x="50" y="272" font-size="11" fill="#4A5568">@udf + arrow config</text>
  <text x="50" y="286" font-size="10" fill="#A0AEC0">Arrow serialization</text>
  <rect x="50" y="296" width="393" height="36" rx="6" fill="#9C4221"/>
  <text x="433" y="320" font-size="18" fill="#FFFFFF" font-weight="bold" text-anchor="end">48.9x</text>
  <text x="60" y="320" font-size="12" fill="#FFFFFF">5.24s at 50M</text>

  <!-- Verdict -->
  <rect x="100" y="352" width="290" height="44" rx="8" fill="#D13913"/>
  <text x="245" y="371" font-size="14" fill="#FFFFFF" text-anchor="middle" font-weight="bold">ZERO DIFFERENCE</text>
  <text x="245" y="388" font-size="11" fill="#FED7D7" text-anchor="middle">Transport format is not the bottleneck</text>

  <!-- Also at 100M -->
  <text x="245" y="420" font-size="10" fill="#9B2C2C" text-anchor="middle">At 100M: 69.2x vs 69.0x = still no difference</text>

  <!-- ═══ RIGHT PANEL: Change Execution Model ═══ -->
  <rect x="495" y="74" width="440" height="370" rx="10" fill="#F0FFF4" stroke="#C6F6D5"/>
  <text x="715" y="100" font-size="16" fill="#276749" text-anchor="middle" font-weight="bold">Experiment 2: Change Execution</text>
  <text x="715" y="118" font-size="11" fill="#276749" text-anchor="middle">Same transport format, different processing model</text>

  <!-- Bar scale: 380px = 49x => 7.76px/x -->
  <!-- Bar: @udf (default) baseline -->
  <text x="520" y="145" font-size="11" fill="#4A5568">@udf (default)</text>
  <rect x="520" y="152" width="380" height="28" rx="5" fill="#D13913"/>
  <text x="892" y="171" font-size="13" fill="#FFFFFF" font-weight="bold" text-anchor="end">48.5x</text>

  <!-- Bar: @udf(useArrow) -->
  <text x="520" y="200" font-size="11" fill="#4A5568">@udf(useArrow=True)</text>
  <rect x="520" y="207" width="161" height="28" rx="5" fill="#E25A1C"/>
  <text x="673" y="226" font-size="13" fill="#FFFFFF" font-weight="bold" text-anchor="end">20.8x</text>
  <text x="693" y="226" font-size="10" fill="#E25A1C" font-weight="bold">2.3x faster</text>

  <!-- Bar: @pandas_udf -->
  <text x="520" y="255" font-size="11" fill="#4A5568">@pandas_udf</text>
  <rect x="520" y="262" width="57" height="28" rx="5" fill="#d4920b"/>
  <text x="585" y="281" font-size="13" fill="#d4920b" font-weight="bold">7.4x</text>
  <text x="625" y="281" font-size="10" fill="#d4920b" font-weight="bold">6.6x faster</text>

  <!-- Bar: @arrow_udf -->
  <text x="520" y="310" font-size="11" fill="#4A5568">@arrow_udf</text>
  <rect x="520" y="317" width="53" height="28" rx="5" fill="#8957e5"/>
  <text x="581" y="336" font-size="13" fill="#8957e5" font-weight="bold">6.8x</text>
  <text x="621" y="336" font-size="10" fill="#238636" font-weight="bold">7.1x faster</text>

  <!-- Verdict -->
  <rect x="570" y="362" width="290" height="44" rx="8" fill="#238636"/>
  <text x="715" y="381" font-size="14" fill="#FFFFFF" text-anchor="middle" font-weight="bold">7x FASTER</text>
  <text x="715" y="398" font-size="11" fill="#C6F6D5" text-anchor="middle">Execution model is the bottleneck</text>

  <!-- Also at 100M -->
  <text x="715" y="420" font-size="10" fill="#276749" text-anchor="middle">At 100M: @arrow_udf 9.1x vs @udf 69.2x = same pattern</text>

  <!-- Key insight -->
  <rect x="50" y="460" width="860" height="78" rx="8" fill="#EBF8FF" stroke="#BEE3F8"/>
  <text x="72" y="485" font-size="13" fill="#2B6CB0" font-weight="bold">Why?</text>
  <text x="105" y="485" font-size="13" fill="#2D3748">The bottleneck is per-row Python function calls (~10M calls/s ceiling), not how bytes are serialized.</text>
  <text x="72" y="505" font-size="12" fill="#4A5568">Arrow transport only helps when paired with a different physical operator (ArrowEvalPython) AND vectorized execution.</text>
  <text x="72" y="523" font-size="12" fill="#4A5568">@arrow_udf and @pandas_udf eliminate per-row calls entirely by processing whole arrays in C/native code.</text>

  <!-- Footer -->
  <text x="480" y="570" font-size="10" fill="#A0AEC0" text-anchor="middle" font-style="italic">Overhead vs built-in functions. Spark 4.1.0, Python 3.12, Spark Connect local[*], 32GB driver memory. Validated 100K to 100M rows.</text>

  <rect x="0" y="616" width="960" height="4" fill="#E25A1C"/>
</svg>