<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 920" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <linearGradient id="bar-pickle" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#D13913"/><stop offset="100%" stop-color="#E45A3B"/>
    </linearGradient>
    <linearGradient id="bar-arrowopt" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#9C4221"/><stop offset="100%" stop-color="#C05621"/>
    </linearGradient>
    <linearGradient id="bar-arrow" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#E25A1C"/><stop offset="100%" stop-color="#F47A3E"/>
    </linearGradient>
    <linearGradient id="bar-arrowudf" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#8957e5"/><stop offset="100%" stop-color="#a371f7"/>
    </linearGradient>
    <linearGradient id="bar-pandas" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#d4920b"/><stop offset="100%" stop-color="#e3a917"/>
    </linearGradient>
    <filter id="shadow">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-opacity="0.06"/>
    </filter>
  </defs>

  <rect width="960" height="920" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="36" font-size="22" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">Python UDF Comparison</text>
  <text x="480" y="56" font-size="13" fill="#718096" text-anchor="middle">Need Python logic? Here's what each UDF type costs at 50M rows (scales to 69x at 100M)</text>

  <!-- Legend -->
  <g transform="translate(120, 72)">
    <rect x="0" y="0" width="12" height="10" rx="2" fill="url(#bar-pickle)"/>
    <text x="16" y="9" font-size="10" fill="#718096">@udf (default)</text>
    <rect x="130" y="0" width="12" height="10" rx="2" fill="url(#bar-arrowopt)"/>
    <text x="146" y="9" font-size="10" fill="#718096">@udf + arrow config</text>
    <rect x="280" y="0" width="12" height="10" rx="2" fill="url(#bar-arrow)"/>
    <text x="296" y="9" font-size="10" fill="#718096">@udf(useArrow)</text>
    <rect x="410" y="0" width="12" height="10" rx="2" fill="url(#bar-arrowudf)"/>
    <text x="426" y="9" font-size="10" fill="#718096">@arrow_udf</text>
    <rect x="510" y="0" width="12" height="10" rx="2" fill="url(#bar-pandas)"/>
    <text x="526" y="9" font-size="10" fill="#718096">@pandas_udf</text>
  </g>

  <!-- ═══════ Arithmetic (x * 2 + 1) ═══════ -->
  <g transform="translate(0, 92)">
    <text x="30" y="14" font-size="14" fill="#1A202C" font-weight="bold">Arithmetic</text>
    <text x="112" y="14" font-size="12" fill="#A0AEC0" font-style="italic">x * 2 + 1</text>

    <text x="210" y="35" font-size="12" fill="#4A5568" text-anchor="end">@udf (default)</text>
    <rect x="220" y="18" width="420" height="26" rx="4" fill="url(#bar-pickle)"/>
    <text x="648" y="36" font-size="12" fill="#1A202C" font-weight="bold">5.20s</text>
    <text x="689" y="36" font-size="11" fill="#A0AEC0">baseline</text>

    <text x="210" y="66" font-size="12" fill="#4A5568" text-anchor="end">@udf + arrow config</text>
    <rect x="220" y="49" width="423" height="26" rx="4" fill="url(#bar-arrowopt)"/>
    <text x="651" y="67" font-size="12" fill="#1A202C" font-weight="bold">5.24s</text>
    <text x="692" y="67" font-size="11" fill="#A0AEC0">1.0x</text>

    <text x="210" y="97" font-size="12" fill="#4A5568" text-anchor="end">@udf(useArrow)</text>
    <rect x="220" y="80" width="180" height="26" rx="4" fill="url(#bar-arrow)"/>
    <text x="408" y="98" font-size="12" fill="#1A202C" font-weight="bold">2.23s</text>
    <text x="449" y="98" font-size="11" fill="#238636" font-weight="bold">2.3x faster</text>

    <text x="210" y="128" font-size="12" fill="#4A5568" text-anchor="end">@arrow_udf</text>
    <rect x="220" y="111" width="59" height="26" rx="4" fill="url(#bar-arrowudf)"/>
    <text x="287" y="129" font-size="12" fill="#1A202C" font-weight="bold">0.73s</text>
    <text x="328" y="129" font-size="11" fill="#238636" font-weight="bold">7.1x faster</text>

    <text x="210" y="159" font-size="12" fill="#4A5568" text-anchor="end">@pandas_udf</text>
    <rect x="220" y="142" width="64" height="26" rx="4" fill="url(#bar-pandas)"/>
    <text x="292" y="160" font-size="12" fill="#1A202C" font-weight="bold">0.79s</text>
    <text x="333" y="160" font-size="11" fill="#238636" font-weight="bold">6.6x faster</text>
  </g>

  <!-- ═══════ String (upper(x) + '_SUFFIX') ═══════ -->
  <g transform="translate(0, 282)">
    <text x="30" y="14" font-size="14" fill="#1A202C" font-weight="bold">String</text>
    <text x="72" y="14" font-size="12" fill="#A0AEC0" font-style="italic">upper(x) + '_SUFFIX'</text>

    <text x="210" y="35" font-size="12" fill="#4A5568" text-anchor="end">@udf (default)</text>
    <rect x="220" y="18" width="420" height="26" rx="4" fill="url(#bar-pickle)"/>
    <text x="648" y="36" font-size="12" fill="#1A202C" font-weight="bold">6.22s</text>
    <text x="689" y="36" font-size="11" fill="#A0AEC0">baseline</text>

    <text x="210" y="66" font-size="12" fill="#4A5568" text-anchor="end">@udf + arrow config</text>
    <rect x="220" y="49" width="421" height="26" rx="4" fill="url(#bar-arrowopt)"/>
    <text x="649" y="67" font-size="12" fill="#1A202C" font-weight="bold">6.23s</text>
    <text x="690" y="67" font-size="11" fill="#A0AEC0">1.0x</text>

    <text x="210" y="97" font-size="12" fill="#4A5568" text-anchor="end">@udf(useArrow)</text>
    <rect x="220" y="80" width="299" height="26" rx="4" fill="url(#bar-arrow)"/>
    <text x="527" y="98" font-size="12" fill="#1A202C" font-weight="bold">4.43s</text>
    <text x="568" y="98" font-size="11" fill="#238636" font-weight="bold">1.4x faster</text>

    <text x="210" y="128" font-size="12" fill="#4A5568" text-anchor="end">@arrow_udf</text>
    <rect x="220" y="111" width="105" height="26" rx="4" fill="url(#bar-arrowudf)"/>
    <text x="333" y="129" font-size="12" fill="#1A202C" font-weight="bold">1.55s</text>
    <text x="374" y="129" font-size="11" fill="#238636" font-weight="bold">4.0x faster</text>

    <text x="210" y="159" font-size="12" fill="#4A5568" text-anchor="end">@pandas_udf</text>
    <rect x="220" y="142" width="170" height="26" rx="4" fill="url(#bar-pandas)"/>
    <text x="398" y="160" font-size="12" fill="#1A202C" font-weight="bold">2.51s</text>
    <text x="439" y="160" font-size="11" fill="#238636" font-weight="bold">2.5x faster</text>
  </g>

  <!-- ═══════ Normal CDF ═══════ -->
  <g transform="translate(0, 472)">
    <text x="30" y="14" font-size="14" fill="#1A202C" font-weight="bold">Normal CDF</text>
    <text x="116" y="14" font-size="12" fill="#A0AEC0" font-style="italic">0.5 * (1 + erf(x / sqrt(2)))</text>

    <text x="210" y="35" font-size="12" fill="#4A5568" text-anchor="end">@udf (default)</text>
    <rect x="220" y="18" width="420" height="26" rx="4" fill="url(#bar-pickle)"/>
    <text x="648" y="36" font-size="12" fill="#1A202C" font-weight="bold">6.18s</text>
    <text x="689" y="36" font-size="11" fill="#A0AEC0">baseline</text>

    <text x="210" y="66" font-size="12" fill="#4A5568" text-anchor="end">@udf + arrow config</text>
    <rect x="220" y="49" width="421" height="26" rx="4" fill="url(#bar-arrowopt)"/>
    <text x="649" y="67" font-size="12" fill="#1A202C" font-weight="bold">6.20s</text>
    <text x="690" y="67" font-size="11" fill="#A0AEC0">1.0x</text>

    <text x="210" y="97" font-size="12" fill="#4A5568" text-anchor="end">@udf(useArrow)</text>
    <rect x="220" y="80" width="200" height="26" rx="4" fill="url(#bar-arrow)"/>
    <text x="428" y="98" font-size="12" fill="#1A202C" font-weight="bold">2.94s</text>
    <text x="469" y="98" font-size="11" fill="#238636" font-weight="bold">2.1x faster</text>

    <text x="210" y="128" font-size="12" fill="#4A5568" text-anchor="end">@arrow_udf</text>
    <rect x="220" y="111" width="52" height="26" rx="4" fill="url(#bar-arrowudf)"/>
    <text x="280" y="129" font-size="12" fill="#1A202C" font-weight="bold">0.76s</text>
    <text x="321" y="129" font-size="11" fill="#238636" font-weight="bold">8.1x faster</text>

    <text x="210" y="159" font-size="12" fill="#4A5568" text-anchor="end">@pandas_udf</text>
    <rect x="220" y="142" width="56" height="26" rx="4" fill="url(#bar-pandas)"/>
    <text x="284" y="160" font-size="12" fill="#1A202C" font-weight="bold">0.82s</text>
    <text x="325" y="160" font-size="11" fill="#238636" font-weight="bold">7.5x faster</text>
  </g>

  <!-- 100M scaling annotation box -->
  <rect x="50" y="662" width="860" height="62" rx="8" fill="#F7FAFC" stroke="#E2E8F0" filter="url(#shadow)"/>
  <text x="72" y="682" font-size="12" fill="#2B6CB0" font-weight="bold">At 100M rows:</text>
  <text x="185" y="682" font-size="12" fill="#2D3748">Row-at-a-time: 10.1s (69x) -- superlinear growth</text>
  <text x="530" y="682" font-size="12" fill="#2D3748">@udf(useArrow): 4.2s (29x)</text>
  <text x="185" y="702" font-size="12" fill="#2D3748">@arrow_udf: 1.3s (9x) -- still fastest Python UDF</text>

  <!-- Key insight box -->
  <rect x="50" y="734" width="860" height="105" rx="8" fill="#F0FFF4" stroke="#C6F6D5" filter="url(#shadow)"/>
  <text x="72" y="757" font-size="12" fill="#276749" font-weight="bold">Bottom line:</text>
  <text x="155" y="757" font-size="12" fill="#2D3748">Switching from @udf to @arrow_udf saves 4.5 seconds per 50M rows on arithmetic (5.20s to 0.73s).</text>
  <text x="72" y="777" font-size="12" fill="#2D3748">@arrow_udf beats @pandas_udf on strings (1.55s vs 2.51s) and matches on numeric workloads.</text>
  <text x="72" y="797" font-size="12" fill="#2D3748">For complex workloads (CDF), @arrow_udf is 8.1x faster than @udf (default).</text>
  <text x="72" y="817" font-size="12" fill="#2D3748">@udf + arrow config still has zero effect.</text>

  <!-- Footer -->
  <text x="480" y="870" font-size="10" fill="#A0AEC0" text-anchor="middle" font-style="italic">Measured on Spark 4.1.0, Python 3.12, Spark Connect local[*], 32GB driver memory. Validated from 100K to 100M rows.</text>

  <rect x="0" y="916" width="960" height="4" fill="#E25A1C"/>
</svg>