<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 540" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <linearGradient id="fill-pickle" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#D13913" stop-opacity="0.12"/>
      <stop offset="100%" stop-color="#D13913" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-arrow" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#E25A1C" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#E25A1C" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-pandas" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d4920b" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#d4920b" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-arrowudf" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#8957e5" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#8957e5" stop-opacity="0.01"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="960" height="540" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="38" font-size="20" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">Overhead Scaling: 100K to 100M Rows</text>
  <text x="480" y="58" font-size="12" fill="#718096" text-anchor="middle">Arithmetic workload (x * 2 + 1) via Spark Connect -- superlinear growth for row-at-a-time UDFs</text>

  <!-- Chart: 720x360, origin (100, 75), Y: 0-70x, 5.143px per 1x -->
  <!-- X: 100K=0, 1M=180, 10M=360, 50M=540, 100M=720 -->
  <g transform="translate(100, 75)">

    <!-- Y gridlines -->
    <g stroke="#EDF2F7" stroke-width="0.5" stroke-dasharray="4,4">
      <line x1="0" y1="360" x2="720" y2="360"/>
      <line x1="0" y1="308.6" x2="720" y2="308.6"/>
      <line x1="0" y1="257.1" x2="720" y2="257.1"/>
      <line x1="0" y1="205.7" x2="720" y2="205.7"/>
      <line x1="0" y1="154.3" x2="720" y2="154.3"/>
      <line x1="0" y1="102.9" x2="720" y2="102.9"/>
      <line x1="0" y1="51.4" x2="720" y2="51.4"/>
      <line x1="0" y1="0" x2="720" y2="0"/>
    </g>

    <!-- Y axis -->
    <line x1="0" y1="0" x2="0" y2="360" stroke="#CBD5E0" stroke-width="1"/>
    <g font-size="11" fill="#718096" text-anchor="end">
      <text x="-10" y="364">0x</text>
      <text x="-10" y="312.6">10x</text>
      <text x="-10" y="261.1">20x</text>
      <text x="-10" y="209.7">30x</text>
      <text x="-10" y="158.3">40x</text>
      <text x="-10" y="106.9">50x</text>
      <text x="-10" y="55.4">60x</text>
      <text x="-10" y="4">70x</text>
    </g>
    <text x="-60" y="180" font-size="12" fill="#4A5568" text-anchor="middle" transform="rotate(-90, -60, 180)">Overhead (x)</text>

    <!-- X axis -->
    <line x1="0" y1="360" x2="720" y2="360" stroke="#CBD5E0" stroke-width="1"/>
    <g font-size="11" fill="#718096" text-anchor="middle">
      <text x="0" y="380">100K</text>
      <text x="180" y="380">1M</text>
      <text x="360" y="380">10M</text>
      <text x="540" y="380">50M</text>
      <text x="720" y="380">100M</text>
    </g>
    <text x="360" y="400" font-size="12" fill="#4A5568" text-anchor="middle">Row Count</text>

    <g stroke="#CBD5E0" stroke-width="1">
      <line x1="0" y1="360" x2="0" y2="365"/>
      <line x1="180" y1="360" x2="180" y2="365"/>
      <line x1="360" y1="360" x2="360" y2="365"/>
      <line x1="540" y1="360" x2="540" y2="365"/>
      <line x1="720" y1="360" x2="720" y2="365"/>
    </g>

    <!-- y = 360 - value * 5.143 -->

    <!-- Pickle (@udf default): 2.7, 4.0, 17.9, 48.5, 69.2 -->
    <polygon points="0,346.1 180,339.4 360,267.9 540,110.6 720,3.9 720,360 540,360 360,360 180,360 0,360" fill="url(#fill-pickle)"/>
    <polyline points="0,346.1 180,339.4 360,267.9 540,110.6 720,3.9" fill="none" stroke="#D13913" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="346.1" r="4" fill="#D13913"/>
    <circle cx="180" cy="339.4" r="4" fill="#D13913"/>
    <circle cx="360" cy="267.9" r="4" fill="#D13913"/>
    <circle cx="540" cy="110.6" r="4" fill="#D13913"/>
    <circle cx="720" cy="3.9" r="5.5" fill="#D13913" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="8" font-size="11" fill="#D13913" font-weight="bold">69.2x</text>

    <!-- Arrow-opt (@udf + arrow config): 2.6, 4.6, 18.1, 48.9, 69.0 -->
    <polyline points="0,346.6 180,336.3 360,266.9 540,108.5 720,5.0" fill="none" stroke="#9C4221" stroke-width="2" stroke-linejoin="round" stroke-dasharray="6,3"/>
    <circle cx="0" cy="346.6" r="3.5" fill="#9C4221"/>
    <circle cx="180" cy="336.3" r="3.5" fill="#9C4221"/>
    <circle cx="360" cy="266.9" r="3.5" fill="#9C4221"/>
    <circle cx="540" cy="108.5" r="3.5" fill="#9C4221"/>
    <circle cx="720" cy="5.0" r="5" fill="#9C4221" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="22" font-size="10" fill="#9C4221" font-weight="bold">69.0x</text>

    <!-- @udf(useArrow): 3.6, 4.0, 9.6, 20.8, 28.6 -->
    <polygon points="0,341.5 180,339.4 360,310.6 540,253.0 720,212.9 720,360 540,360 360,360 180,360 0,360" fill="url(#fill-arrow)"/>
    <polyline points="0,341.5 180,339.4 360,310.6 540,253.0 720,212.9" fill="none" stroke="#E25A1C" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="341.5" r="4" fill="#E25A1C"/>
    <circle cx="180" cy="339.4" r="4" fill="#E25A1C"/>
    <circle cx="360" cy="310.6" r="4" fill="#E25A1C"/>
    <circle cx="540" cy="253.0" r="4" fill="#E25A1C"/>
    <circle cx="720" cy="212.9" r="5.5" fill="#E25A1C" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="217" font-size="11" fill="#E25A1C" font-weight="bold">28.6x</text>

    <!-- @pandas_udf: 2.9, 3.0, 4.6, 7.4, 9.6 -->
    <polygon points="0,345.1 180,344.6 360,336.3 540,321.9 720,310.6 720,360 540,360 360,360 180,360 0,360" fill="url(#fill-pandas)"/>
    <polyline points="0,345.1 180,344.6 360,336.3 540,321.9 720,310.6" fill="none" stroke="#d4920b" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="345.1" r="4" fill="#d4920b"/>
    <circle cx="180" cy="344.6" r="4" fill="#d4920b"/>
    <circle cx="360" cy="336.3" r="4" fill="#d4920b"/>
    <circle cx="540" cy="321.9" r="4" fill="#d4920b"/>
    <circle cx="720" cy="310.6" r="5.5" fill="#d4920b" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="306" font-size="11" fill="#d4920b" font-weight="bold">9.6x</text>

    <!-- @arrow_udf: 2.5, 3.0, 4.5, 6.8, 9.1 -->
    <polygon points="0,347.1 180,344.6 360,336.9 540,325.0 720,313.2 720,360 540,360 360,360 180,360 0,360" fill="url(#fill-arrowudf)"/>
    <polyline points="0,347.1 180,344.6 360,336.9 540,325.0 720,313.2" fill="none" stroke="#8957e5" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="347.1" r="4" fill="#8957e5"/>
    <circle cx="180" cy="344.6" r="4" fill="#8957e5"/>
    <circle cx="360" cy="336.9" r="4" fill="#8957e5"/>
    <circle cx="540" cy="325.0" r="4" fill="#8957e5"/>
    <circle cx="720" cy="313.2" r="5.5" fill="#8957e5" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="321" font-size="11" fill="#8957e5" font-weight="bold">9.1x</text>

    <!-- SQL: ~0.9 flat -->
    <polyline points="0,355.4 180,355.4 360,355.4 540,355.4 720,355.4" fill="none" stroke="#1f6feb" stroke-width="2" stroke-linejoin="round"/>
    <circle cx="0" cy="355.4" r="3.5" fill="#1f6feb"/>
    <circle cx="180" cy="355.4" r="3.5" fill="#1f6feb"/>
    <circle cx="360" cy="355.4" r="3.5" fill="#1f6feb"/>
    <circle cx="540" cy="355.4" r="3.5" fill="#1f6feb"/>
    <circle cx="720" cy="355.4" r="4" fill="#1f6feb" stroke="#FFFFFF" stroke-width="1.5"/>

    <!-- Built-in: 1.0x flat -->
    <polyline points="0,354.9 180,354.9 360,354.9 540,354.9 720,354.9" fill="none" stroke="#238636" stroke-width="2" stroke-linejoin="round"/>
    <circle cx="0" cy="354.9" r="3.5" fill="#238636"/>
    <circle cx="180" cy="354.9" r="3.5" fill="#238636"/>
    <circle cx="360" cy="354.9" r="3.5" fill="#238636"/>
    <circle cx="540" cy="354.9" r="3.5" fill="#238636"/>
    <circle cx="720" cy="354.9" r="4" fill="#238636" stroke="#FFFFFF" stroke-width="1.5"/>
    <text x="735" y="357" font-size="10" fill="#718096">~1x</text>

    <!-- Annotations -->
    <g transform="translate(380, 40)">
      <rect x="0" y="0" width="180" height="40" rx="5" fill="#FFF5F5" stroke="#FED7D7"/>
      <text x="90" y="17" font-size="11" fill="#D13913" text-anchor="middle" font-weight="600">69x at 100M rows</text>
      <text x="90" y="33" font-size="10" fill="#9B2C2C" text-anchor="middle">superlinear per-row overhead</text>
    </g>

    <g transform="translate(380, 175)">
      <rect x="0" y="0" width="180" height="40" rx="5" fill="#FFF5F0" stroke="#FEEBC8"/>
      <text x="90" y="17" font-size="11" fill="#E25A1C" text-anchor="middle" font-weight="600">@udf(useArrow) 29x</text>
      <text x="90" y="33" font-size="10" fill="#9C4221" text-anchor="middle">batched transport, scalar exec</text>
    </g>

    <g transform="translate(380, 270)">
      <rect x="0" y="0" width="190" height="40" rx="5" fill="#FFFFF0" stroke="#FEFCBF"/>
      <text x="95" y="17" font-size="11" fill="#d4920b" text-anchor="middle" font-weight="600">@pandas_udf ~10x</text>
      <text x="95" y="33" font-size="11" fill="#8957e5" text-anchor="middle" font-weight="600">@arrow_udf ~9x</text>
    </g>
  </g>

  <!-- Legend -->
  <g transform="translate(40, 500)" font-size="10.5">
    <line x1="0" y1="6" x2="20" y2="6" stroke="#238636" stroke-width="2.5"/>
    <circle cx="10" cy="6" r="3" fill="#238636"/>
    <text x="26" y="10" fill="#4A5568">Built-in</text>

    <line x1="88" y1="6" x2="108" y2="6" stroke="#1f6feb" stroke-width="2.5"/>
    <circle cx="98" cy="6" r="3" fill="#1f6feb"/>
    <text x="114" y="10" fill="#4A5568">SQL UDF</text>

    <line x1="178" y1="6" x2="198" y2="6" stroke="#8957e5" stroke-width="2.5"/>
    <circle cx="188" cy="6" r="3" fill="#8957e5"/>
    <text x="204" y="10" fill="#4A5568">@arrow_udf</text>

    <line x1="290" y1="6" x2="310" y2="6" stroke="#d4920b" stroke-width="2.5"/>
    <circle cx="300" cy="6" r="3" fill="#d4920b"/>
    <text x="316" y="10" fill="#4A5568">@pandas_udf</text>

    <line x1="410" y1="6" x2="430" y2="6" stroke="#E25A1C" stroke-width="2.5"/>
    <circle cx="420" cy="6" r="3" fill="#E25A1C"/>
    <text x="436" y="10" fill="#4A5568">@udf(useArrow)</text>

    <line x1="555" y1="6" x2="575" y2="6" stroke="#9C4221" stroke-width="2.5" stroke-dasharray="6,3"/>
    <circle cx="565" cy="6" r="3" fill="#9C4221"/>
    <text x="581" y="10" fill="#4A5568">@udf + arrow config</text>

    <line x1="725" y1="6" x2="745" y2="6" stroke="#D13913" stroke-width="2.5"/>
    <circle cx="735" cy="6" r="3" fill="#D13913"/>
    <text x="751" y="10" fill="#4A5568">@udf (default)</text>
  </g>

  <text x="480" y="526" font-size="10" fill="#A0AEC0" text-anchor="middle" font-style="italic">Measured on Spark 4.1.0, Python 3.12, Spark Connect local[*], 32GB driver memory. Validated from 100K to 100M rows.</text>

  <rect x="0" y="536" width="960" height="4" fill="#E25A1C"/>
</svg>
