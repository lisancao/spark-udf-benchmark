<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 540" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <linearGradient id="fill-pickle" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#D13913" stop-opacity="0.12"/>
      <stop offset="100%" stop-color="#D13913" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-arrow" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#E25A1C" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#E25A1C" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-pandas" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d4920b" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#d4920b" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-arrowudf" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#8957e5" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#8957e5" stop-opacity="0.01"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="960" height="540" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="38" font-size="20" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">Overhead Scaling: 100K to 50M Rows</text>
  <text x="480" y="58" font-size="12" fill="#718096" text-anchor="middle">Arithmetic workload (x * 2 + 1) via Spark Connect -- superlinear growth for row-at-a-time UDFs</text>

  <!-- Chart: 720x360, origin (100, 75), Y: 0-50x, 7.2px per 1x -->
  <g transform="translate(100, 75)">

    <!-- Y gridlines -->
    <g stroke="#EDF2F7" stroke-width="0.5" stroke-dasharray="4,4">
      <line x1="0" y1="360" x2="720" y2="360"/>
      <line x1="0" y1="288" x2="720" y2="288"/>
      <line x1="0" y1="216" x2="720" y2="216"/>
      <line x1="0" y1="144" x2="720" y2="144"/>
      <line x1="0" y1="72" x2="720" y2="72"/>
      <line x1="0" y1="0" x2="720" y2="0"/>
    </g>

    <!-- Y axis -->
    <line x1="0" y1="0" x2="0" y2="360" stroke="#CBD5E0" stroke-width="1"/>
    <g font-size="11" fill="#718096" text-anchor="end">
      <text x="-10" y="364">0x</text>
      <text x="-10" y="292">10x</text>
      <text x="-10" y="220">20x</text>
      <text x="-10" y="148">30x</text>
      <text x="-10" y="76">40x</text>
      <text x="-10" y="4">50x</text>
    </g>
    <text x="-60" y="180" font-size="12" fill="#4A5568" text-anchor="middle" transform="rotate(-90, -60, 180)">Overhead (x)</text>

    <!-- X axis -->
    <line x1="0" y1="360" x2="720" y2="360" stroke="#CBD5E0" stroke-width="1"/>
    <g font-size="11" fill="#718096" text-anchor="middle">
      <text x="0" y="380">100K</text>
      <text x="240" y="380">1M</text>
      <text x="480" y="380">10M</text>
      <text x="720" y="380">50M</text>
    </g>
    <text x="360" y="400" font-size="12" fill="#4A5568" text-anchor="middle">Row Count</text>

    <g stroke="#CBD5E0" stroke-width="1">
      <line x1="0" y1="360" x2="0" y2="365"/>
      <line x1="240" y1="360" x2="240" y2="365"/>
      <line x1="480" y1="360" x2="480" y2="365"/>
      <line x1="720" y1="360" x2="720" y2="365"/>
    </g>

    <!-- y = 360 - value * 7.2 -->

    <!-- Pickle (@udf default): 2.7, 4.0, 17.9, 48.5 -->
    <!-- y: 340.6, 331.2, 231.1, 10.8 -->
    <polygon points="0,340.6 240,331.2 480,231.1 720,10.8 720,360 480,360 240,360 0,360" fill="url(#fill-pickle)"/>
    <polyline points="0,340.6 240,331.2 480,231.1 720,10.8" fill="none" stroke="#D13913" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="340.6" r="4" fill="#D13913"/>
    <circle cx="240" cy="331.2" r="4" fill="#D13913"/>
    <circle cx="480" cy="231.1" r="4" fill="#D13913"/>
    <circle cx="720" cy="10.8" r="5.5" fill="#D13913" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="15" font-size="11" fill="#D13913" font-weight="bold">48.5x</text>

    <!-- Arrow-opt (@udf + arrow config): 2.6, 4.6, 18.1, 48.9 -->
    <!-- y: 341.3, 326.9, 229.7, 7.9 -->
    <polyline points="0,341.3 240,326.9 480,229.7 720,7.9" fill="none" stroke="#9C4221" stroke-width="2" stroke-linejoin="round" stroke-dasharray="6,3"/>
    <circle cx="0" cy="341.3" r="3.5" fill="#9C4221"/>
    <circle cx="240" cy="326.9" r="3.5" fill="#9C4221"/>
    <circle cx="480" cy="229.7" r="3.5" fill="#9C4221"/>
    <circle cx="720" cy="7.9" r="5" fill="#9C4221" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="1" font-size="11" fill="#9C4221" font-weight="bold">48.9x</text>

    <!-- @udf(useArrow): 3.6, 4.0, 9.6, 20.8 -->
    <!-- y: 334.1, 331.2, 290.9, 210.2 -->
    <polygon points="0,334.1 240,331.2 480,290.9 720,210.2 720,360 480,360 240,360 0,360" fill="url(#fill-arrow)"/>
    <polyline points="0,334.1 240,331.2 480,290.9 720,210.2" fill="none" stroke="#E25A1C" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="334.1" r="4" fill="#E25A1C"/>
    <circle cx="240" cy="331.2" r="4" fill="#E25A1C"/>
    <circle cx="480" cy="290.9" r="4" fill="#E25A1C"/>
    <circle cx="720" cy="210.2" r="5.5" fill="#E25A1C" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="214" font-size="11" fill="#E25A1C" font-weight="bold">20.8x</text>

    <!-- @pandas_udf: 2.9, 3.0, 4.6, 7.4 -->
    <!-- y: 339.1, 338.4, 326.9, 306.7 -->
    <polygon points="0,339.1 240,338.4 480,326.9 720,306.7 720,360 480,360 240,360 0,360" fill="url(#fill-pandas)"/>
    <polyline points="0,339.1 240,338.4 480,326.9 720,306.7" fill="none" stroke="#d4920b" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="339.1" r="4" fill="#d4920b"/>
    <circle cx="240" cy="338.4" r="4" fill="#d4920b"/>
    <circle cx="480" cy="326.9" r="4" fill="#d4920b"/>
    <circle cx="720" cy="306.7" r="5.5" fill="#d4920b" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="303" font-size="11" fill="#d4920b" font-weight="bold">7.4x</text>

    <!-- @arrow_udf (NEW): 2.5, 3.0, 4.5, 6.8 -->
    <!-- y: 342.0, 338.4, 327.6, 311.0 -->
    <polygon points="0,342.0 240,338.4 480,327.6 720,311.0 720,360 480,360 240,360 0,360" fill="url(#fill-arrowudf)"/>
    <polyline points="0,342.0 240,338.4 480,327.6 720,311.0" fill="none" stroke="#8957e5" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="342.0" r="4" fill="#8957e5"/>
    <circle cx="240" cy="338.4" r="4" fill="#8957e5"/>
    <circle cx="480" cy="327.6" r="4" fill="#8957e5"/>
    <circle cx="720" cy="311.0" r="5.5" fill="#8957e5" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="319" font-size="11" fill="#8957e5" font-weight="bold">6.8x</text>

    <!-- SQL: ~0.9 flat -->
    <polyline points="0,355.0 240,355.7 480,354.2 720,353.5" fill="none" stroke="#1f6feb" stroke-width="2" stroke-linejoin="round"/>
    <circle cx="0" cy="355.0" r="3.5" fill="#1f6feb"/>
    <circle cx="240" cy="355.7" r="3.5" fill="#1f6feb"/>
    <circle cx="480" cy="354.2" r="3.5" fill="#1f6feb"/>
    <circle cx="720" cy="353.5" r="4" fill="#1f6feb" stroke="#FFFFFF" stroke-width="1.5"/>

    <!-- Built-in: 1.0x flat -->
    <polyline points="0,352.8 240,352.8 480,352.8 720,352.8" fill="none" stroke="#238636" stroke-width="2" stroke-linejoin="round"/>
    <circle cx="0" cy="352.8" r="3.5" fill="#238636"/>
    <circle cx="240" cy="352.8" r="3.5" fill="#238636"/>
    <circle cx="480" cy="352.8" r="3.5" fill="#238636"/>
    <circle cx="720" cy="352.8" r="4" fill="#238636" stroke="#FFFFFF" stroke-width="1.5"/>
    <text x="735" y="357" font-size="10" fill="#718096">~1x</text>

    <!-- Annotations -->
    <g transform="translate(500, 70)">
      <rect x="0" y="0" width="168" height="40" rx="5" fill="#FFF5F5" stroke="#FED7D7"/>
      <text x="84" y="17" font-size="11" fill="#D13913" text-anchor="middle" font-weight="600">Superlinear growth</text>
      <text x="84" y="33" font-size="10" fill="#9B2C2C" text-anchor="middle">per-row serde dominates</text>
    </g>

    <g transform="translate(500, 180)">
      <rect x="0" y="0" width="168" height="40" rx="5" fill="#FFF5F0" stroke="#FEEBC8"/>
      <text x="84" y="17" font-size="11" fill="#E25A1C" text-anchor="middle" font-weight="600">@udf(useArrow) mid-range</text>
      <text x="84" y="33" font-size="10" fill="#9C4221" text-anchor="middle">batched transport, scalar exec</text>
    </g>

    <g transform="translate(500, 268)">
      <rect x="0" y="0" width="190" height="40" rx="5" fill="#FFFFF0" stroke="#FEFCBF"/>
      <text x="95" y="17" font-size="11" fill="#d4920b" text-anchor="middle" font-weight="600">@pandas_udf ~7x</text>
      <text x="95" y="33" font-size="11" fill="#8957e5" text-anchor="middle" font-weight="600">@arrow_udf ~7x</text>
    </g>
  </g>

  <!-- Legend -->
  <g transform="translate(40, 500)" font-size="10.5">
    <line x1="0" y1="6" x2="20" y2="6" stroke="#238636" stroke-width="2.5"/>
    <circle cx="10" cy="6" r="3" fill="#238636"/>
    <text x="26" y="10" fill="#4A5568">Built-in</text>

    <line x1="88" y1="6" x2="108" y2="6" stroke="#1f6feb" stroke-width="2.5"/>
    <circle cx="98" cy="6" r="3" fill="#1f6feb"/>
    <text x="114" y="10" fill="#4A5568">SQL UDF</text>

    <line x1="178" y1="6" x2="198" y2="6" stroke="#8957e5" stroke-width="2.5"/>
    <circle cx="188" cy="6" r="3" fill="#8957e5"/>
    <text x="204" y="10" fill="#4A5568">@arrow_udf</text>

    <line x1="290" y1="6" x2="310" y2="6" stroke="#d4920b" stroke-width="2.5"/>
    <circle cx="300" cy="6" r="3" fill="#d4920b"/>
    <text x="316" y="10" fill="#4A5568">@pandas_udf</text>

    <line x1="410" y1="6" x2="430" y2="6" stroke="#E25A1C" stroke-width="2.5"/>
    <circle cx="420" cy="6" r="3" fill="#E25A1C"/>
    <text x="436" y="10" fill="#4A5568">@udf(useArrow)</text>

    <line x1="555" y1="6" x2="575" y2="6" stroke="#9C4221" stroke-width="2.5" stroke-dasharray="6,3"/>
    <circle cx="565" cy="6" r="3" fill="#9C4221"/>
    <text x="581" y="10" fill="#4A5568">@udf + arrow config</text>

    <line x1="725" y1="6" x2="745" y2="6" stroke="#D13913" stroke-width="2.5"/>
    <circle cx="735" cy="6" r="3" fill="#D13913"/>
    <text x="751" y="10" fill="#4A5568">@udf (default)</text>
  </g>

  <rect x="0" y="536" width="960" height="4" fill="#E25A1C"/>
</svg>