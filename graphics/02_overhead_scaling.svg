<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 520" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <linearGradient id="fill-pickle" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#D13913" stop-opacity="0.12"/>
      <stop offset="100%" stop-color="#D13913" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-arrow" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#E25A1C" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#E25A1C" stop-opacity="0.01"/>
    </linearGradient>
    <linearGradient id="fill-pandas" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#d4920b" stop-opacity="0.08"/>
      <stop offset="100%" stop-color="#d4920b" stop-opacity="0.01"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="960" height="520" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="38" font-size="20" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">Overhead Scaling: 100K to 50M Rows</text>
  <text x="480" y="58" font-size="12" fill="#718096" text-anchor="middle">Arithmetic workload (x * 2 + 1) via Spark Connect -- superlinear growth for row-at-a-time UDFs</text>

  <!-- Chart: 720x360, origin (100, 75), Y: 0-45x, 8px per 1x -->
  <g transform="translate(100, 75)">

    <!-- Y gridlines -->
    <g stroke="#EDF2F7" stroke-width="0.5" stroke-dasharray="4,4">
      <line x1="0" y1="360" x2="720" y2="360"/>
      <line x1="0" y1="280" x2="720" y2="280"/>
      <line x1="0" y1="200" x2="720" y2="200"/>
      <line x1="0" y1="120" x2="720" y2="120"/>
      <line x1="0" y1="40" x2="720" y2="40"/>
    </g>

    <!-- Y axis -->
    <line x1="0" y1="0" x2="0" y2="360" stroke="#CBD5E0" stroke-width="1"/>
    <g font-size="11" fill="#718096" text-anchor="end">
      <text x="-10" y="364">0x</text>
      <text x="-10" y="284">10x</text>
      <text x="-10" y="204">20x</text>
      <text x="-10" y="124">30x</text>
      <text x="-10" y="44">40x</text>
    </g>
    <text x="-60" y="180" font-size="12" fill="#4A5568" text-anchor="middle" transform="rotate(-90, -60, 180)">Overhead (x)</text>

    <!-- X axis -->
    <line x1="0" y1="360" x2="720" y2="360" stroke="#CBD5E0" stroke-width="1"/>
    <g font-size="11" fill="#718096" text-anchor="middle">
      <text x="0" y="380">100K</text>
      <text x="240" y="380">1M</text>
      <text x="480" y="380">10M</text>
      <text x="720" y="380">50M</text>
    </g>
    <text x="360" y="400" font-size="12" fill="#4A5568" text-anchor="middle">Row Count</text>

    <g stroke="#CBD5E0" stroke-width="1">
      <line x1="0" y1="360" x2="0" y2="365"/>
      <line x1="240" y1="360" x2="240" y2="365"/>
      <line x1="480" y1="360" x2="480" y2="365"/>
      <line x1="720" y1="360" x2="720" y2="365"/>
    </g>

    <!-- y = 360 - value * 8 -->

    <!-- Pickle: 2.2, 3.3, 14.7, 39.7 -->
    <!-- y: 342.4, 333.6, 242.4, 42.4 -->
    <polygon points="0,342.4 240,333.6 480,242.4 720,42.4 720,360 480,360 240,360 0,360" fill="url(#fill-pickle)"/>
    <polyline points="0,342.4 240,333.6 480,242.4 720,42.4" fill="none" stroke="#D13913" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="342.4" r="4" fill="#D13913"/>
    <circle cx="240" cy="333.6" r="4" fill="#D13913"/>
    <circle cx="480" cy="242.4" r="4" fill="#D13913"/>
    <circle cx="720" cy="42.4" r="5.5" fill="#D13913" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="47" font-size="11" fill="#D13913" font-weight="bold">39.7x</text>

    <!-- Arrow-opt: 2.2, 3.8, 15.1, 40.6 -->
    <!-- y: 342.4, 329.6, 239.2, 35.2 -->
    <polyline points="0,342.4 240,329.6 480,239.2 720,35.2" fill="none" stroke="#9C4221" stroke-width="2" stroke-linejoin="round" stroke-dasharray="6,3"/>
    <circle cx="0" cy="342.4" r="3.5" fill="#9C4221"/>
    <circle cx="240" cy="329.6" r="3.5" fill="#9C4221"/>
    <circle cx="480" cy="239.2" r="3.5" fill="#9C4221"/>
    <circle cx="720" cy="35.2" r="5" fill="#9C4221" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="32" font-size="11" fill="#9C4221" font-weight="bold">40.6x</text>

    <!-- Arrow UDF: 2.9, 3.2, 7.7, 16.6 -->
    <!-- y: 336.8, 334.4, 298.4, 227.2 -->
    <polygon points="0,336.8 240,334.4 480,298.4 720,227.2 720,360 480,360 240,360 0,360" fill="url(#fill-arrow)"/>
    <polyline points="0,336.8 240,334.4 480,298.4 720,227.2" fill="none" stroke="#E25A1C" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="336.8" r="4" fill="#E25A1C"/>
    <circle cx="240" cy="334.4" r="4" fill="#E25A1C"/>
    <circle cx="480" cy="298.4" r="4" fill="#E25A1C"/>
    <circle cx="720" cy="227.2" r="5.5" fill="#E25A1C" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="231" font-size="11" fill="#E25A1C" font-weight="bold">16.6x</text>

    <!-- Pandas: 2.5, 2.6, 4.0, 6.5 -->
    <!-- y: 340.0, 339.2, 328.0, 308.0 -->
    <polygon points="0,340.0 240,339.2 480,328.0 720,308.0 720,360 480,360 240,360 0,360" fill="url(#fill-pandas)"/>
    <polyline points="0,340.0 240,339.2 480,328.0 720,308.0" fill="none" stroke="#d4920b" stroke-width="2.5" stroke-linejoin="round"/>
    <circle cx="0" cy="340.0" r="4" fill="#d4920b"/>
    <circle cx="240" cy="339.2" r="4" fill="#d4920b"/>
    <circle cx="480" cy="328.0" r="4" fill="#d4920b"/>
    <circle cx="720" cy="308.0" r="5.5" fill="#d4920b" stroke="#FFFFFF" stroke-width="2"/>
    <text x="735" y="312" font-size="11" fill="#d4920b" font-weight="bold">6.5x</text>

    <!-- SQL: ~0.8 flat -->
    <polyline points="0,354.4 240,355.2 480,353.6 720,353.6" fill="none" stroke="#1f6feb" stroke-width="2" stroke-linejoin="round"/>
    <circle cx="0" cy="354.4" r="3.5" fill="#1f6feb"/>
    <circle cx="240" cy="355.2" r="3.5" fill="#1f6feb"/>
    <circle cx="480" cy="353.6" r="3.5" fill="#1f6feb"/>
    <circle cx="720" cy="353.6" r="4" fill="#1f6feb" stroke="#FFFFFF" stroke-width="1.5"/>

    <!-- Built-in: 1.0x flat -->
    <polyline points="0,352.0 240,352.0 480,352.0 720,352.0" fill="none" stroke="#238636" stroke-width="2" stroke-linejoin="round"/>
    <circle cx="0" cy="352.0" r="3.5" fill="#238636"/>
    <circle cx="240" cy="352.0" r="3.5" fill="#238636"/>
    <circle cx="480" cy="352.0" r="3.5" fill="#238636"/>
    <circle cx="720" cy="352.0" r="4" fill="#238636" stroke="#FFFFFF" stroke-width="1.5"/>
    <text x="735" y="356" font-size="10" fill="#718096">~1x</text>

    <!-- Annotations -->
    <g transform="translate(500, 100)">
      <rect x="0" y="0" width="168" height="40" rx="5" fill="#FFF5F5" stroke="#FED7D7"/>
      <text x="84" y="17" font-size="11" fill="#D13913" text-anchor="middle" font-weight="600">Superlinear growth</text>
      <text x="84" y="33" font-size="10" fill="#9B2C2C" text-anchor="middle">per-row serde dominates</text>
    </g>

    <g transform="translate(500, 200)">
      <rect x="0" y="0" width="168" height="40" rx="5" fill="#FFF5F0" stroke="#FEEBC8"/>
      <text x="84" y="17" font-size="11" fill="#E25A1C" text-anchor="middle" font-weight="600">@udf(useArrow) mid-range</text>
      <text x="84" y="33" font-size="10" fill="#9C4221" text-anchor="middle">batched transport, scalar exec</text>
    </g>

    <g transform="translate(500, 278)">
      <rect x="0" y="0" width="168" height="25" rx="5" fill="#FFFFF0" stroke="#FEFCBF"/>
      <text x="84" y="17" font-size="11" fill="#d4920b" text-anchor="middle" font-weight="600">@pandas_udf plateau ~5-7x</text>
    </g>
  </g>

  <!-- Legend -->
  <g transform="translate(105, 485)" font-size="10.5">
    <line x1="0" y1="6" x2="20" y2="6" stroke="#238636" stroke-width="2.5"/>
    <circle cx="10" cy="6" r="3" fill="#238636"/>
    <text x="26" y="10" fill="#4A5568">Built-in</text>

    <line x1="90" y1="6" x2="110" y2="6" stroke="#1f6feb" stroke-width="2.5"/>
    <circle cx="100" cy="6" r="3" fill="#1f6feb"/>
    <text x="116" y="10" fill="#4A5568">SQL UDF</text>

    <line x1="185" y1="6" x2="205" y2="6" stroke="#d4920b" stroke-width="2.5"/>
    <circle cx="195" cy="6" r="3" fill="#d4920b"/>
    <text x="211" y="10" fill="#4A5568">@pandas_udf</text>

    <line x1="300" y1="6" x2="320" y2="6" stroke="#E25A1C" stroke-width="2.5"/>
    <circle cx="310" cy="6" r="3" fill="#E25A1C"/>
    <text x="326" y="10" fill="#4A5568">@udf(useArrow)</text>

    <line x1="415" y1="6" x2="435" y2="6" stroke="#9C4221" stroke-width="2.5" stroke-dasharray="6,3"/>
    <circle cx="425" cy="6" r="3" fill="#9C4221"/>
    <text x="441" y="10" fill="#4A5568">@udf + arrow config</text>

    <line x1="560" y1="6" x2="580" y2="6" stroke="#D13913" stroke-width="2.5"/>
    <circle cx="570" cy="6" r="3" fill="#D13913"/>
    <text x="586" y="10" fill="#4A5568">@udf (default)</text>
  </g>

  <rect x="0" y="516" width="960" height="4" fill="#E25A1C"/>
</svg>