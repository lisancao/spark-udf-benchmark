<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 580" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <linearGradient id="g-builtin" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#238636"/><stop offset="100%" stop-color="#2ea043"/>
    </linearGradient>
    <linearGradient id="g-sql" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#1f6feb"/><stop offset="100%" stop-color="#388bfd"/>
    </linearGradient>
    <linearGradient id="g-pandas" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#d4920b"/><stop offset="100%" stop-color="#e3a917"/>
    </linearGradient>
    <linearGradient id="g-arrowopt" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#E25A1C"/><stop offset="100%" stop-color="#F47A3E"/>
    </linearGradient>
    <linearGradient id="g-pickle" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#D13913"/><stop offset="100%" stop-color="#E45A3B"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="960" height="580" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="40" font-size="20" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">UDF Overhead at 50 Million Rows</text>
  <text x="480" y="60" font-size="12" fill="#718096" text-anchor="middle">Relative overhead vs built-in functions (Spark 4.1.0, local[2])</text>

  <!-- Chart: labels on left (200px), bars from x=210 to x=900 (690px range for 50x) -->
  <!-- 1x = 13.8px -->
  <g transform="translate(0, 80)">

    <!-- X-axis gridlines (from bar origin x=210) -->
    <g stroke="#EDF2F7" stroke-width="0.5" stroke-dasharray="3,3">
      <line x1="210" y1="0" x2="210" y2="420"/>
      <line x1="348" y1="0" x2="348" y2="420"/>
      <line x1="486" y1="0" x2="486" y2="420"/>
      <line x1="624" y1="0" x2="624" y2="420"/>
      <line x1="762" y1="0" x2="762" y2="420"/>
      <line x1="900" y1="0" x2="900" y2="420"/>
    </g>
    <!-- X-axis labels -->
    <g font-size="10" fill="#A0AEC0" text-anchor="middle">
      <text x="210" y="435">0x</text>
      <text x="348" y="435">10x</text>
      <text x="486" y="435">20x</text>
      <text x="624" y="435">30x</text>
      <text x="762" y="435">40x</text>
      <text x="900" y="435">50x</text>
    </g>

    <!-- ── ARITHMETIC ── -->
    <rect x="15" y="0" width="185" height="22" rx="3" fill="#F7FAFC"/>
    <text x="22" y="16" font-size="13" fill="#2D3748" font-weight="bold">Arithmetic</text>
    <text x="185" y="16" font-size="10" fill="#A0AEC0" text-anchor="end">x * 2 + 1</text>

    <!-- row height=24, gap=2, bar height=22 -->
    <!-- Built-in 1.0x -->
    <text x="200" y="42" font-size="10" fill="#4A5568" text-anchor="end">Built-in</text>
    <rect x="210" y="30" width="13.8" height="18" rx="3" fill="url(#g-builtin)"/>
    <text x="230" y="44" font-size="10" fill="#238636" font-weight="600">1.0x</text>

    <!-- SQL 0.9x -->
    <text x="200" y="66" font-size="10" fill="#4A5568" text-anchor="end">SQL UDF</text>
    <rect x="210" y="54" width="12.4" height="18" rx="3" fill="url(#g-sql)"/>
    <text x="228" y="68" font-size="10" fill="#1f6feb" font-weight="600">0.9x</text>

    <!-- Pandas 7.4x -->
    <text x="200" y="90" font-size="10" fill="#4A5568" text-anchor="end">Pandas UDF</text>
    <rect x="210" y="78" width="102.1" height="18" rx="3" fill="url(#g-pandas)"/>
    <text x="318" y="92" font-size="10" fill="#d4920b" font-weight="600">7.4x</text>

    <!-- Arrow-opt 45.0x -->
    <text x="200" y="114" font-size="10" fill="#4A5568" text-anchor="end">Arrow-opt @udf</text>
    <rect x="210" y="102" width="621" height="18" rx="3" fill="url(#g-arrowopt)"/>
    <text x="838" y="116" font-size="10" fill="#E25A1C" font-weight="700">45.0x</text>

    <!-- Pickle 44.8x -->
    <text x="200" y="138" font-size="10" fill="#4A5568" text-anchor="end">Pickle @udf</text>
    <rect x="210" y="126" width="618.2" height="18" rx="3" fill="url(#g-pickle)"/>
    <text x="835" y="140" font-size="10" fill="#D13913" font-weight="700">44.8x</text>

    <!-- ── STRING ── -->
    <rect x="15" y="158" width="185" height="22" rx="3" fill="#F7FAFC"/>
    <text x="22" y="174" font-size="13" fill="#2D3748" font-weight="bold">String</text>
    <text x="185" y="174" font-size="10" fill="#A0AEC0" text-anchor="end">upper + suffix</text>

    <!-- Built-in 1.0x -->
    <text x="200" y="200" font-size="10" fill="#4A5568" text-anchor="end">Built-in</text>
    <rect x="210" y="188" width="13.8" height="18" rx="3" fill="url(#g-builtin)"/>
    <text x="230" y="202" font-size="10" fill="#238636" font-weight="600">1.0x</text>

    <!-- SQL 1.0x -->
    <text x="200" y="224" font-size="10" fill="#4A5568" text-anchor="end">SQL UDF</text>
    <rect x="210" y="212" width="13.5" height="18" rx="3" fill="url(#g-sql)"/>
    <text x="230" y="226" font-size="10" fill="#1f6feb" font-weight="600">1.0x</text>

    <!-- Pandas 4.6x -->
    <text x="200" y="248" font-size="10" fill="#4A5568" text-anchor="end">Pandas UDF</text>
    <rect x="210" y="236" width="63.5" height="18" rx="3" fill="url(#g-pandas)"/>
    <text x="280" y="250" font-size="10" fill="#d4920b" font-weight="600">4.6x</text>

    <!-- Arrow-opt 10.7x -->
    <text x="200" y="272" font-size="10" fill="#4A5568" text-anchor="end">Arrow-opt @udf</text>
    <rect x="210" y="260" width="147.7" height="18" rx="3" fill="url(#g-arrowopt)"/>
    <text x="364" y="274" font-size="10" fill="#E25A1C" font-weight="600">10.7x</text>

    <!-- Pickle 10.8x -->
    <text x="200" y="296" font-size="10" fill="#4A5568" text-anchor="end">Pickle @udf</text>
    <rect x="210" y="284" width="149.0" height="18" rx="3" fill="url(#g-pickle)"/>
    <text x="366" y="298" font-size="10" fill="#D13913" font-weight="600">10.8x</text>

    <!-- ── NORMAL CDF ── -->
    <rect x="15" y="316" width="185" height="22" rx="3" fill="#F7FAFC"/>
    <text x="22" y="332" font-size="13" fill="#2D3748" font-weight="bold">Normal CDF</text>
    <text x="185" y="332" font-size="10" fill="#A0AEC0" text-anchor="end">erf approximation</text>

    <!-- Built-in 1.0x -->
    <text x="200" y="358" font-size="10" fill="#4A5568" text-anchor="end">Built-in</text>
    <rect x="210" y="346" width="13.8" height="18" rx="3" fill="url(#g-builtin)"/>
    <text x="230" y="360" font-size="10" fill="#238636" font-weight="600">1.0x</text>

    <!-- Pandas 5.3x -->
    <text x="200" y="382" font-size="10" fill="#4A5568" text-anchor="end">Pandas UDF</text>
    <rect x="210" y="370" width="73.1" height="18" rx="3" fill="url(#g-pandas)"/>
    <text x="290" y="384" font-size="10" fill="#d4920b" font-weight="600">5.3x</text>

    <!-- Arrow-opt 37.2x -->
    <text x="200" y="406" font-size="10" fill="#4A5568" text-anchor="end">Arrow-opt @udf</text>
    <rect x="210" y="394" width="513.4" height="18" rx="3" fill="url(#g-arrowopt)"/>
    <text x="730" y="408" font-size="10" fill="#E25A1C" font-weight="700">37.2x</text>

    <!-- Pickle 34.4x -->
    <text x="200" y="430" font-size="10" fill="#4A5568" text-anchor="end">Pickle @udf</text>
    <rect x="210" y="418" width="474.7" height="18" rx="3" fill="url(#g-pickle)"/>
    <text x="691" y="432" font-size="10" fill="#D13913" font-weight="700">34.4x</text>
  </g>

  <!-- Legend -->
  <g transform="translate(230, 545)" font-size="10">
    <rect x="0" y="0" width="12" height="12" rx="2" fill="url(#g-builtin)"/>
    <text x="16" y="10" fill="#4A5568">Built-in</text>
    <rect x="80" y="0" width="12" height="12" rx="2" fill="url(#g-sql)"/>
    <text x="96" y="10" fill="#4A5568">SQL UDF</text>
    <rect x="160" y="0" width="12" height="12" rx="2" fill="url(#g-pandas)"/>
    <text x="176" y="10" fill="#4A5568">Pandas UDF</text>
    <rect x="270" y="0" width="12" height="12" rx="2" fill="url(#g-arrowopt)"/>
    <text x="286" y="10" fill="#4A5568">Arrow-opt @udf</text>
    <rect x="396" y="0" width="12" height="12" rx="2" fill="url(#g-pickle)"/>
    <text x="412" y="10" fill="#4A5568">Pickle @udf</text>
  </g>

  <rect x="0" y="576" width="960" height="4" fill="#E25A1C"/>
</svg>