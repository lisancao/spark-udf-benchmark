<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 640" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <linearGradient id="g-builtin" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#238636"/><stop offset="100%" stop-color="#2ea043"/>
    </linearGradient>
    <linearGradient id="g-sql" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#1f6feb"/><stop offset="100%" stop-color="#388bfd"/>
    </linearGradient>
    <linearGradient id="g-arrow" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#E25A1C"/><stop offset="100%" stop-color="#F47A3E"/>
    </linearGradient>
    <linearGradient id="g-pandas" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#d4920b"/><stop offset="100%" stop-color="#e3a917"/>
    </linearGradient>
    <linearGradient id="g-arrowopt" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#9C4221"/><stop offset="100%" stop-color="#C05621"/>
    </linearGradient>
    <linearGradient id="g-pickle" x1="0" x2="1" y1="0" y2="0">
      <stop offset="0%" stop-color="#D13913"/><stop offset="100%" stop-color="#E45A3B"/>
    </linearGradient>
  </defs>

  <!-- Background -->
  <rect width="960" height="640" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="40" font-size="20" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">UDF Overhead at 50 Million Rows</text>
  <text x="480" y="60" font-size="12" fill="#718096" text-anchor="middle">Relative overhead vs built-in functions (Spark 4.1.0, Spark Connect, local[*])</text>

  <!-- Scale: 690px for 45x => 15.33px per 1x -->
  <g transform="translate(0, 80)">

    <!-- X-axis gridlines from x=210 -->
    <g stroke="#EDF2F7" stroke-width="0.5" stroke-dasharray="3,3">
      <line x1="210" y1="0" x2="210" y2="490"/>
      <line x1="363.3" y1="0" x2="363.3" y2="490"/>
      <line x1="516.7" y1="0" x2="516.7" y2="490"/>
      <line x1="670" y1="0" x2="670" y2="490"/>
      <line x1="823.3" y1="0" x2="823.3" y2="490"/>
    </g>
    <g font-size="10" fill="#A0AEC0" text-anchor="middle">
      <text x="210" y="505">0x</text>
      <text x="363.3" y="505">10x</text>
      <text x="516.7" y="505">20x</text>
      <text x="670" y="505">30x</text>
      <text x="823.3" y="505">40x</text>
    </g>

    <!-- ── ARITHMETIC ── -->
    <rect x="15" y="0" width="185" height="22" rx="3" fill="#F7FAFC"/>
    <text x="22" y="16" font-size="13" fill="#2D3748" font-weight="bold">Arithmetic</text>
    <text x="185" y="16" font-size="10" fill="#A0AEC0" text-anchor="end">x * 2 + 1</text>

    <text x="200" y="42" font-size="10" fill="#4A5568" text-anchor="end">Built-in</text>
    <rect x="210" y="30" width="15.3" height="18" rx="3" fill="url(#g-builtin)"/>
    <text x="232" y="44" font-size="10" fill="#238636" font-weight="600">1.0x</text>

    <text x="200" y="64" font-size="10" fill="#4A5568" text-anchor="end">SQL UDF</text>
    <rect x="210" y="52" width="12.3" height="18" rx="3" fill="url(#g-sql)"/>
    <text x="228" y="66" font-size="10" fill="#1f6feb" font-weight="600">0.8x</text>

    <text x="200" y="86" font-size="10" fill="#4A5568" text-anchor="end">@pandas_udf</text>
    <rect x="210" y="74" width="99.6" height="18" rx="3" fill="url(#g-pandas)"/>
    <text x="316" y="88" font-size="10" fill="#d4920b" font-weight="600">6.5x</text>

    <text x="200" y="108" font-size="10" fill="#4A5568" text-anchor="end">@udf(useArrow)</text>
    <rect x="210" y="96" width="254.5" height="18" rx="3" fill="url(#g-arrow)"/>
    <text x="471" y="110" font-size="10" fill="#E25A1C" font-weight="600">16.6x</text>

    <text x="200" y="130" font-size="10" fill="#4A5568" text-anchor="end">@udf (default)</text>
    <rect x="210" y="118" width="608.6" height="18" rx="3" fill="url(#g-pickle)"/>
    <text x="825" y="132" font-size="10" fill="#D13913" font-weight="700">39.7x</text>

    <text x="200" y="152" font-size="10" fill="#4A5568" text-anchor="end">@udf + arrow config</text>
    <rect x="210" y="140" width="622.4" height="18" rx="3" fill="url(#g-arrowopt)"/>
    <text x="839" y="154" font-size="10" fill="#9C4221" font-weight="700">40.6x</text>

    <!-- ── STRING ── -->
    <rect x="15" y="175" width="185" height="22" rx="3" fill="#F7FAFC"/>
    <text x="22" y="191" font-size="13" fill="#2D3748" font-weight="bold">String</text>
    <text x="185" y="191" font-size="10" fill="#A0AEC0" text-anchor="end">upper + suffix</text>

    <text x="200" y="217" font-size="10" fill="#4A5568" text-anchor="end">Built-in</text>
    <rect x="210" y="205" width="15.3" height="18" rx="3" fill="url(#g-builtin)"/>
    <text x="232" y="219" font-size="10" fill="#238636" font-weight="600">1.0x</text>

    <text x="200" y="239" font-size="10" fill="#4A5568" text-anchor="end">SQL UDF</text>
    <rect x="210" y="227" width="15.3" height="18" rx="3" fill="url(#g-sql)"/>
    <text x="232" y="241" font-size="10" fill="#1f6feb" font-weight="600">1.0x</text>

    <text x="200" y="261" font-size="10" fill="#4A5568" text-anchor="end">@pandas_udf</text>
    <rect x="210" y="249" width="73.6" height="18" rx="3" fill="url(#g-pandas)"/>
    <text x="290" y="263" font-size="10" fill="#d4920b" font-weight="600">4.8x</text>

    <text x="200" y="283" font-size="10" fill="#4A5568" text-anchor="end">@udf(useArrow)</text>
    <rect x="210" y="271" width="88.9" height="18" rx="3" fill="url(#g-arrow)"/>
    <text x="305" y="285" font-size="10" fill="#E25A1C" font-weight="600">5.8x</text>

    <text x="200" y="305" font-size="10" fill="#4A5568" text-anchor="end">@udf (default)</text>
    <rect x="210" y="293" width="171.7" height="18" rx="3" fill="url(#g-pickle)"/>
    <text x="388" y="307" font-size="10" fill="#D13913" font-weight="600">11.2x</text>

    <text x="200" y="327" font-size="10" fill="#4A5568" text-anchor="end">@udf + arrow config</text>
    <rect x="210" y="315" width="171.7" height="18" rx="3" fill="url(#g-arrowopt)"/>
    <text x="388" y="329" font-size="10" fill="#9C4221" font-weight="600">11.2x</text>

    <!-- ── NORMAL CDF ── -->
    <rect x="15" y="350" width="185" height="22" rx="3" fill="#F7FAFC"/>
    <text x="22" y="366" font-size="13" fill="#2D3748" font-weight="bold">Normal CDF</text>
    <text x="185" y="366" font-size="10" fill="#A0AEC0" text-anchor="end">erf approximation</text>

    <text x="200" y="392" font-size="10" fill="#4A5568" text-anchor="end">Built-in</text>
    <rect x="210" y="380" width="15.3" height="18" rx="3" fill="url(#g-builtin)"/>
    <text x="232" y="394" font-size="10" fill="#238636" font-weight="600">1.0x</text>

    <text x="200" y="414" font-size="10" fill="#4A5568" text-anchor="end">@pandas_udf</text>
    <rect x="210" y="402" width="79.7" height="18" rx="3" fill="url(#g-pandas)"/>
    <text x="296" y="416" font-size="10" fill="#d4920b" font-weight="600">5.2x</text>

    <text x="200" y="436" font-size="10" fill="#4A5568" text-anchor="end">@udf(useArrow)</text>
    <rect x="210" y="424" width="243.7" height="18" rx="3" fill="url(#g-arrow)"/>
    <text x="460" y="438" font-size="10" fill="#E25A1C" font-weight="600">15.9x</text>

    <text x="200" y="458" font-size="10" fill="#4A5568" text-anchor="end">@udf (default)</text>
    <rect x="210" y="446" width="541.2" height="18" rx="3" fill="url(#g-pickle)"/>
    <text x="758" y="460" font-size="10" fill="#D13913" font-weight="700">35.3x</text>

    <text x="200" y="480" font-size="10" fill="#4A5568" text-anchor="end">@udf + arrow config</text>
    <rect x="210" y="468" width="539.6" height="18" rx="3" fill="url(#g-arrowopt)"/>
    <text x="756" y="482" font-size="10" fill="#9C4221" font-weight="700">35.2x</text>
  </g>

  <!-- Legend -->
  <g transform="translate(140, 600)" font-size="10">
    <rect x="0" y="0" width="12" height="12" rx="2" fill="url(#g-builtin)"/>
    <text x="16" y="10" fill="#4A5568">Built-in</text>
    <rect x="70" y="0" width="12" height="12" rx="2" fill="url(#g-sql)"/>
    <text x="86" y="10" fill="#4A5568">SQL UDF</text>
    <rect x="145" y="0" width="12" height="12" rx="2" fill="url(#g-pandas)"/>
    <text x="161" y="10" fill="#4A5568">@pandas_udf</text>
    <rect x="245" y="0" width="12" height="12" rx="2" fill="url(#g-arrow)"/>
    <text x="261" y="10" fill="#4A5568">@udf(useArrow)</text>
    <rect x="345" y="0" width="12" height="12" rx="2" fill="url(#g-arrowopt)"/>
    <text x="361" y="10" fill="#4A5568">@udf + arrow config</text>
    <rect x="470" y="0" width="12" height="12" rx="2" fill="url(#g-pickle)"/>
    <text x="486" y="10" fill="#4A5568">@udf (default)</text>
  </g>

  <rect x="0" y="636" width="960" height="4" fill="#E25A1C"/>
</svg>