<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 960 580" font-family="'Segoe UI', Arial, Helvetica, sans-serif">
  <defs>
    <pattern id="hatching" width="10" height="10" patternUnits="userSpaceOnUse" patternTransform="rotate(45)">
      <line x1="0" y1="0" x2="0" y2="10" stroke="#E2E8F0" stroke-width="1.5"/>
    </pattern>
    <filter id="shadow">
      <feDropShadow dx="0" dy="1" stdDeviation="2" flood-opacity="0.06"/>
    </filter>
  </defs>

  <rect width="960" height="580" fill="#FFFFFF"/>
  <rect x="0" y="0" width="960" height="4" fill="#E25A1C"/>

  <!-- Title -->
  <text x="480" y="36" font-size="22" fill="#1A202C" text-anchor="middle" font-weight="bold" letter-spacing="1">Transport vs Execution Model</text>
  <text x="480" y="56" font-size="13" fill="#718096" text-anchor="middle">Two independent axes determine Python UDF performance -- only one of them matters</text>

  <!-- Axis labels -->
  <!-- Column headers (transport axis) -->
  <text x="352" y="100" font-size="14" fill="#4A5568" text-anchor="middle" font-weight="bold">Pickle Transport</text>
  <text x="352" y="115" font-size="11" fill="#A0AEC0" text-anchor="middle">Python pickle serialization</text>
  <text x="592" y="100" font-size="14" fill="#4A5568" text-anchor="middle" font-weight="bold">Arrow Transport</text>
  <text x="592" y="115" font-size="11" fill="#A0AEC0" text-anchor="middle">Apache Arrow columnar format</text>

  <!-- Row headers (execution axis) -->
  <text x="215" y="188" font-size="13" fill="#4A5568" text-anchor="end" font-weight="bold">ROW-AT-A-TIME</text>
  <text x="215" y="204" font-size="11" fill="#A0AEC0" text-anchor="end">per-row Python calls</text>

  <text x="215" y="338" font-size="13" fill="#4A5568" text-anchor="end" font-weight="bold">VECTORIZED BATCH</text>
  <text x="215" y="354" font-size="11" fill="#A0AEC0" text-anchor="end">Pandas/NumPy operations</text>

  <!-- ═══════ Cell (1,1): Pickle x Row-at-a-time ═══════ -->
  <rect x="235" y="130" width="230" height="120" rx="8" fill="#FFF5F5" stroke="#FED7D7" filter="url(#shadow)"/>
  <text x="350" y="178" font-size="30" fill="#D13913" text-anchor="middle" font-weight="bold">~40x</text>
  <text x="350" y="200" font-size="13" fill="#9B2C2C" text-anchor="middle">@udf (default)</text>
  <text x="350" y="218" font-size="11" fill="#A0AEC0" text-anchor="middle">pickle serde, per-row exec</text>
  <text x="350" y="240" font-size="10" fill="#FC8181" text-anchor="middle">4.71s at 50M rows</text>

  <!-- ═══════ Cell (1,2): Arrow x Row-at-a-time ═══════ -->
  <rect x="478" y="130" width="230" height="120" rx="8" fill="#FFF5F5" stroke="#FED7D7" filter="url(#shadow)"/>
  <text x="593" y="178" font-size="30" fill="#D13913" text-anchor="middle" font-weight="bold">~40x</text>
  <text x="593" y="200" font-size="13" fill="#9B2C2C" text-anchor="middle">@udf + arrow config</text>
  <text x="593" y="218" font-size="11" fill="#A0AEC0" text-anchor="middle">arrow format, same exec model</text>
  <text x="593" y="240" font-size="10" fill="#FC8181" text-anchor="middle">4.81s at 50M rows</text>

  <!-- "equals" indicator between top cells -->
  <text x="472" y="195" font-size="22" fill="#A0AEC0" text-anchor="middle">=</text>

  <!-- ═══════ Cell (2,1): Pickle x Vectorized -- doesn't exist ═══════ -->
  <rect x="235" y="280" width="230" height="120" rx="8" fill="url(#hatching)" stroke="#E2E8F0" filter="url(#shadow)"/>
  <rect x="235" y="280" width="230" height="120" rx="8" fill="#F7FAFC" opacity="0.7"/>
  <text x="350" y="340" font-size="13" fill="#A0AEC0" text-anchor="middle" font-style="italic">not possible</text>
  <text x="350" y="358" font-size="11" fill="#CBD5E0" text-anchor="middle">pickle can't batch</text>

  <!-- ═══════ Cell (2,2): Arrow x Vectorized -- Pandas UDF ═══════ -->
  <rect x="478" y="280" width="230" height="120" rx="8" fill="#F0FFF4" stroke="#C6F6D5" filter="url(#shadow)"/>
  <text x="593" y="322" font-size="30" fill="#238636" text-anchor="middle" font-weight="bold">~5-7x</text>
  <text x="593" y="344" font-size="13" fill="#276749" text-anchor="middle">@pandas_udf</text>
  <text x="593" y="362" font-size="11" fill="#68D391" text-anchor="middle">arrow batches + NumPy/Pandas ops</text>
  <text x="593" y="382" font-size="10" fill="#276749" text-anchor="middle">0.77s at 50M rows</text>

  <!-- Vertical improvement arrow (right side of arrow column) -->
  <line x1="718" y1="190" x2="718" y2="330" stroke="#238636" stroke-width="2" marker-end="url(#arrowDown)"/>
  <defs>
    <marker id="arrowDown" markerWidth="8" markerHeight="6" refX="4" refY="6" orient="auto">
      <polygon points="0 0, 8 0, 4 6" fill="#238636"/>
    </marker>
  </defs>
  <text x="730" y="250" font-size="12" fill="#238636" font-weight="bold">6-8x</text>
  <text x="730" y="265" font-size="11" fill="#238636">faster</text>

  <!-- Arrow UDF floating annotation -->
  <rect x="740" y="190" width="195" height="75" rx="6" fill="#FFFFF0" stroke="#FEFCBF" filter="url(#shadow)"/>
  <text x="838" y="212" font-size="12" fill="#975A16" text-anchor="middle" font-weight="bold">Arrow UDF (useArrow)</text>
  <text x="838" y="234" font-size="22" fill="#E25A1C" text-anchor="middle" font-weight="bold">~6-17x</text>
  <text x="838" y="254" font-size="10" fill="#A0AEC0" text-anchor="middle">Arrow transport, per-row exec</text>

  <!-- Key insight box -->
  <rect x="50" y="425" width="860" height="70" rx="8" fill="#EBF8FF" stroke="#BEE3F8" filter="url(#shadow)"/>
  <text x="72" y="450" font-size="13" fill="#2B6CB0" font-weight="bold">Key insight:</text>
  <text x="168" y="450" font-size="13" fill="#2D3748">Transport format barely matters (39.7x vs 40.6x). Execution model is everything.</text>
  <text x="72" y="472" font-size="12" fill="#4A5568">Arrow batches only help when paired with vectorized execution (@pandas_udf). Changing transport alone changes nothing.</text>

  <!-- Horizontal "no difference" annotation between top cells -->
  <line x1="350" y1="258" x2="593" y2="258" stroke="#A0AEC0" stroke-width="1" stroke-dasharray="4,3"/>
  <text x="472" y="272" font-size="10" fill="#A0AEC0" text-anchor="middle">transport change: negligible</text>

  <!-- Footer -->
  <text x="480" y="530" font-size="10" fill="#A0AEC0" text-anchor="middle" font-style="italic">Overhead vs built-in functions. Measured on Spark 4.1.0, Python 3.12, Spark Connect local[*]. 50M rows, median of 3 runs.</text>

  <rect x="0" y="576" width="960" height="4" fill="#E25A1C"/>
</svg>